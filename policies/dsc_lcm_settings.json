{"policy":{"name":"windows-dsc_local_configuration_manager","short_description":"Windows - DSC Local Configuration Manager","description":null,"settings":{"tests":{"output_format":null}},"operating_system_family_id":null,"operating_system_id":null,"type":null},"data":[{"DSC Local Configuation Manager":[{"id":"DSC-Local-Configuation-ManagerEnsure-that-the-LCM-is-operating-with-version-2-","name":"Ensure that the LCM is operating with version 2.","error":false,"checks":{"LCMVersion":[{"exp":"2","check":"includes","expected":"2","background":"An LCM version less than 2.0 indicates a version of PowerShell older than 5.0, on any host that supports version 4.0 version 5 is also supported. To ensure maximum compatibility with DSC an upgrade is recommended.","remediation":"Install WMF 5.0 on server 2012 via KB3191564 and KB3191565, or via the Download Center for 2008 R2."}]},"ci_path":["*","DSC Local Configuration Manager","*"],"check_type":"other","path_error":"","description":"Ensure that the LCM is operating with version 2.","nodeGroupsOpen":true},{"id":"DSC-Local-Configuation-ManagerDebug-mode-is-disabled-","name":"Debug mode is disabled.","error":false,"checks":{"DebugMode":[{"check":"excludes","expected":"True","background":"Enabling debug mode causes the LCM to always load the latest version of the DSC resources specified in its configuration. Consequently, resources are not cached and can lead to performance issues.","remediation":"Set the LCM Debug Mode to false, or leave it undefined. LocalConfigurationManager { DebugMode = $false }","valueSelectList":null,"attributeSelectList":null,"availableAttributes":null}]},"ci_path":["*","DSC Local Configuration Manager","*"],"check_type":"other","path_error":"","description":"Debug mode is disabled.","nodeGroupsOpen":true}]},{"Refresh and Application":[{"id":"Refresh-and-ApplicationConfiguration-Mode-Refresh-Frequency","name":"Configuration Mode Refresh Frequency","error":false,"checks":{"ConfigurationModeFrequencyMins":[{"check":"equals","expected":"15","background":"Consistency across an environment for the refresh interval helps ensure state integrity.","remediation":"Set the LCM to a consistent value across the environment.\n\nLocalConfigurationManager\n{\n    ConfigurationModeFrequencyMins = '15'\n}","valueSelectList":null,"attributeSelectList":null,"availableAttributes":null}]},"ci_path":["*","DSC Local Configuration Manager","*"],"check_type":"other","path_error":"","description":"Configuration Mode Refresh Frequency","nodeGroupsOpen":true},{"id":"Refresh-and-ApplicationRefresh-Frequency-Consistency","name":"Refresh Frequency Consistency","error":false,"checks":{"RefreshFrequencyMins":[{"check":"equals","expected":"30","background":"The refresh frequency is in many ways a philosophical value, set it to a high frequency and the understanding of changes to configurations can be missed, conversely, a high frequency ensures that state integrity is maintained.","remediation":"Set the refresh mode frequency to a consistent interval throughout your group or environment.\n\nLocalConfigurationManager\n{\n    RefreshFrequencyMins = '15'\n}","valueSelectList":null,"attributeSelectList":null,"availableAttributes":null}]},"ci_path":["*","DSC Local Configuration Manager","*"],"check_type":"other","path_error":"","description":"Refresh Frequency Consistency","nodeGroupsOpen":true}]},{"Configuration Preference":[{"id":"Configuration-PreferenceAction-after-Reboot","name":"Action after Reboot","error":false,"checks":{"ActionAfterReboot":[{"check":"equals","expected":"ContinueConfiguration","background":"Certain DSC resources may require a reboot first before they can configure system state.  By setting the value to ContinueConfiguration it allows the configuration to continue after the system reboot.","remediation":"To allow configurations to continue after a reboot set the option appropriately in the LCM.\n\nLocalConfigurationManager\n{\n    ActionAfterReboot = 'ContinueConfiguration'\n}","valueSelectList":null,"attributeSelectList":null,"availableAttributes":null}]},"ci_path":["*","DSC Local Configuration Manager","*"],"check_type":"other","path_error":"","description":"Action after Reboot","nodeGroupsOpen":true},{"id":"Configuration-PreferenceReboot-Preference-Consistency-Check","name":"Reboot Preference Consistency Check","error":false,"checks":{"RebootIfNeeded":[{"check":"equals","expected":"false","background":"Reboot preference dictates whether the DSC configuration will automatically reboot a device as necessary to apply a configuration.","remediation":"LocalConfigurationManager\n{\n    RebootIfNeeded = $false\n}","valueSelectList":null,"attributeSelectList":null,"availableAttributes":null}]},"ci_path":["*","DSC Local Configuration Manager","*"],"check_type":"other","path_error":"","description":"Reboot Preference Consistency Check","nodeGroupsOpen":true},{"id":"Configuration-PreferenceValidate-the-configuration-mode-of-the-Local-Configuration-Manager-","name":"Validate the configuration mode of the Local Configuration Manager.","error":false,"checks":{"ConfigurationMode":[{"check":"equals","expected":"ApplyAndMonitor","background":"This preference dictates how an LCM handles configuration state, it should be set appropriately to organizational preference.\n\n\n Disabled - The LCM does not run.  This value is set in cases where a third-party management technology (e.g. Chef/Puppet/Ansible), is handling configuration of the device. Such technologies can use DSC resource modules under the hood, but won't leverage the LCM to enact configuration.\n• ApplyOnce. The LCM applies the current configuration, and then stops running until a manual run is initiated.\n• ApplyAndMonitor. The LCM applies the current configuration, and validates based on the ConfigurationModeFrequencyMinutes value. It does not attempt to restore the configuration state, but will report a status of the defined resource definitions.\n• ApplyAndAutoCorrect. The LCM applies the current configuration, and validates based on the ConfigurationModeFrequencyMinutes value. It will attempt to fix out-of-compliance configuration settings and will report on the result of those actions.","remediation":"Set the configuration mode preference in the LCM in accordance with organizational policies.\n\nLocalConfigurationManager\n{\n    ConfigurationMode = 'ApplyAndMonitor'\n}","valueSelectList":null,"attributeSelectList":null,"availableAttributes":null}]},"ci_path":["*","DSC Local Configuration Manager","*"],"check_type":"other","path_error":"","description":"Validate the configuration mode of the Local Configuration Manager.","nodeGroupsOpen":true}]}],"scan_options":{}}